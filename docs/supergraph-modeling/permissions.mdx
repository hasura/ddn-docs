---
sidebar_position: 6
sidebar_label: Permissions
description:
  "This page provides an understanding of how to define permissions, control access or set authorization rules on output
  types, models, and commands in your supergraph. It essentially makes management of roles and accessibility simple and
  efficient."
toc_max_heading_level: 4
keywords:
  - hasura
  - hasura permissions guide
  - api authorization
  - define permissions
  - model permissions
  - command permissions
  - data domains
  - api control rules
  - access management
seoFrontMatterUpdated: true
---

import Thumbnail from "@site/src/components/Thumbnail";

# Permissions

## Introduction

You can define permissions, (also known as access control or authorization rules) on [object types](./types.mdx),
[models](./models.mdx) and [commands](./commands.mdx) in your data domain.

The following types of permissions can be defined:

- `TypePermissions` define which fields are allowed to be accessed by a role. Defining permissions on output types is
  useful, as certain fields may be sensitive and should only be accessible to particular roles.
- `ModelPermissions` define which objects or rows within a model are allowed to be accessed by a role.
- `CommandPermissions` defines whether the command is executable by a role.

## Metadata structure

### ModelPermissions

Definition of permissions for an OpenDD model.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `modelName` | `string` | `true` | The name of the model for which permissions are being defined. |
| `permissions` | [`ModelPermission`](#modelpermission) | `true` | A list of model permissions, one for each role. |



Example:

```yaml
modelName: Articles
permissions:
  - role: admin
    select:
      filter: null
  - role: user
    select:
      filter:
        fieldComparison:
          field: author_id
          operator: _eq
          value:
            sessionVariable: x-hasura-user-id

```

#### ModelPermission

Defines the permissions for an OpenDD model.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `role` | `string` | `true` | The role for which permissions are being defined. |
| `select` | [`SelectPermission`](#selectpermission) | `false` | The permissions for selecting from this model for this role. If this is null, the role is not allowed to query the model. |



Example:

```yaml
role: user
select:
  filter:
    fieldComparison:
      field: author_id
      operator: _eq
      value:
        sessionVariable: x-hasura-user-id

```

#### SelectPermission

Defines the permissions for selecting a model for a role.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `filter` | `undefined` | `true` | Filter expression when selecting rows for this model. Null filter implies all rows are selectable. |

#### ModelPredicate

A predicate that can be used to restrict the objects returned when querying a model.



Example:

```yaml
fieldComparison:
  field: author_id
  operator: _eq
  value:
    sessionVariable: x-hasura-user-id

```

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `fieldComparison` | `object` | `true` | Field comparision predicate filters objects based on a field value. |

#### FieldComparisonPredicate

Field comparision predicate filters objects based on a field value.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `field` | `string` | `true` | The field name of the object type of the model to compare. |
| `operator` | `string` | `true` | The name of the operator to use for comparison. |
| `value` | [`ValueExpression`](#valueexpression) | `true` | The value expression to compare against. |

#### ValueExpression

An expression which evaluates to a value that can be used in permissions.

#### Literal

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `literal` |  | `true` |  |

#### SessionVariable

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `sessionVariable` | `string` | `true` | Used to represent the name of a session variable, like "x-hasura-role". |

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `fieldIsNull` | `object` | `true` |  |

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `field` | `string` | `true` | The name of a field in a user-defined object type. |

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `relationship` | `object` | `true` | Relationship predicate filters objects of a source model based on a predicate on the related model. |

#### RelationshipPredicate

Relationship predicate filters objects of a source model based on a predicate on the related model.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `name` | `string` | `true` | The name of the relationship of the object type of the model to follow. |
| `predicate` | [`ModelPredicate`](#modelpredicate) | `false` | The predicate to apply on the related objects. If this is null, then the predicate evaluates to true as long as there is at least one related object present. |

#### And

Evaluates to true if all sub-predicates evaluate to true.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `and` | [`ModelPredicate`](#modelpredicate) | `true` |  |

#### Or

Evaluates to true if any of the sub-predicates evaluate to true.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `or` | [`ModelPredicate`](#modelpredicate) | `true` |  |

#### Not

Evaluates to true if the sub-predicate evaluates to false.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `not` |  | `true` | A predicate that can be used to restrict the objects returned when querying a model. |

### TypePermissions

Definition of permissions for an OpenDD type.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `typeName` | `string` | `true` | The name of the type for which permissions are being defined. Must be an object type. |
| `permissions` | [`TypePermission`](#typepermission) | `true` | A list of type permissions, one for each role. |



Example:

```yaml
typeName: article
permissions:
  - role: admin
    output:
      allowedFields:
        - article_id
        - author_id
        - title
  - role: user
    output:
      allowedFields:
        - article_id
        - author_id

```

#### TypePermission

Defines permissions for a particular role for a type.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `role` | `string` | `true` | The role for which permissions are being defined. |
| `output` | [`TypeOutputPermission`](#typeoutputpermission) | `false` | Permissions for this role when this type is used in an output context. If null, this type is inaccessible for this role in an output context. |



Example:

```yaml
role: user
output:
  allowedFields:
    - article_id
    - author_id

```

#### TypeOutputPermission

Permissions for a type for a particular role when used in an output context.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `allowedFields` |  | `true` | Fields of the type that are accessible for a role |

### CommandPermissions

Definition of permissions for an OpenDD command.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `commandName` | `string` | `true` | The name of the command for which permissions are being defined. |
| `permissions` | [`CommandPermission`](#commandpermission) | `true` | A list of command permissions, one for each role. |



Example:

```yaml
commandName: get_article_by_id
permissions:
  - role: admin
    allowExecution: true
  - role: user
    allowExecution: true

```

#### CommandPermission

Defines the permissions for a role for a command.

| Name | Type | Required | Description |
| ---- | ---- | -------- | ----------- |
| `role` | `string` | `true` | The role for which permissions are being defined. |
| `allowExecution` | `boolean` | `true` | Whether the command is executable by the role. |



Example:

```yaml
role: user
allowExecution: true

```

