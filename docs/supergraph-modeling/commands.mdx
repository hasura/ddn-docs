---
sidebar_position: 7
sidebar_label: Commands
description:
  "Begin executing business logic directly from your GraphQL API using Hasura Data Domain Specification commands.
  Connect to REST endpoints, custom servers or serverless functions and better manage your back-end functions."
keywords:
  - hasura commands
  - hasura dds
  - graphql api
  - business logic
  - data connector
  - rest endpoint
  - custom server
  - serverless function
  - graphql instruction
  - command configuration
seoFrontMatterUpdated: true
toc_max_heading_level: 4
---

# Commands

## Introduction

A "Command" in Hasura DDN represents an action that can be performed to returning some type of result (eg: `LogUserIn`).
Very loosely, you can think of commands as the verbs or, "actions" of your data domain.

Commands have a fixed definition and are backed by **functions** or **procedures**, allowing you to add top level
methods to your API, or, add a custom field to an existing [model](./models.mdx).

Commands allow you to execute business logic directly from your GraphQL API and are useful in validating, processing or
enriching data, calling another API, or, for example, logging a user in.

Once a command is declared it will then often be referenced by `Relationship` objects in order to compose them with each
other or models, and also by `Permissions` objects to control access to the command execution.

<details>
<summary>View an example of a function, the command and an API query it enables</summary>

A function in TypeScript with the [Node.js Lambda connector](https://github.com/hasura/ndc-nodejs-lambda):

```typescript
/**
 * @readonly Exposes the function as an NDC function (the function should only query data without making modifications)
 */
export function hello(name?: string) {
  return `hello ${name ?? "world"}`;
}
```

It would be represented in our metadata as the following command:

```yaml
---
kind: Command
version: v1
definition:
  name: Hello
  outputType: String!
  arguments:
    - name: name
      type: String
  source:
    dataConnectorName: my_data_connector
    dataConnectorCommand:
      function: hello
  graphql:
    rootFieldName: hello
    rootFieldKind: Query
```

And then queried in the API like so:

```graphql
query {
  hello(name: "Hasura")
}
```

</details>

### Functions vs. Procedures

Functions are used for **read** operations. They will not modify the data in the database. They can only be used to
retrieve data. As relationships are a querying construct, **only functions** can be used in relationships.

Procedures are used for **write** operations. They can modify the data in the database. They can be used to create,
update, or delete data.

## Metadata structure

### Command {#command-command}

The definition of a command. A command is a user-defined operation which can take arguments and returns an output. The
semantics of a command are opaque to the Open DD specification.

| Key          | Value                           | Required | Description                                                                                                                                                  |
| ------------ | ------------------------------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `kind`       | `Command`                       | true     |                                                                                                                                                              |
| `version`    | `v1`                            | true     |                                                                                                                                                              |
| `definition` | [CommandV1](#command-commandv1) | true     | Definition of an OpenDD Command, which is a custom operation that can take arguments and returns an output. The semantics of a command are opaque to OpenDD. |

**Example:**

```yaml
kind: Command
version: v1
definition:
  name: get_latest_article
  outputType: commandArticle
  arguments: []
  source:
    dataConnectorName: data_connector
    dataConnectorCommand:
      function: latest_article
    argumentMapping: {}
  graphql:
    rootFieldName: getLatestArticle
    rootFieldKind: Query
  description: Get the latest article
```

#### CommandV1 {#command-commandv1}

Definition of an OpenDD Command, which is a custom operation that can take arguments and returns an output. The
semantics of a command are opaque to OpenDD.

| Key           | Value                                                                | Required | Description                                                                                                      |
| ------------- | -------------------------------------------------------------------- | -------- | ---------------------------------------------------------------------------------------------------------------- |
| `name`        | [CommandName](#command-commandname)                                  | true     | The name of the command.                                                                                         |
| `outputType`  | [TypeReference](#command-typereference)                              | true     | The return type of the command.                                                                                  |
| `arguments`   | [[ArgumentDefinition](#command-argumentdefinition)]                  | false    | The list of arguments accepted by this command. Defaults to no arguments.                                        |
| `source`      | [CommandSource](#command-commandsource) / null                       | false    | The source configuration for this command.                                                                       |
| `graphql`     | [CommandGraphQlDefinition](#command-commandgraphqldefinition) / null | false    | Configuration for how this command should appear in the GraphQL schema.                                          |
| `description` | string / null                                                        | false    | The description of the command. Gets added to the description of the command's root field in the GraphQL schema. |

#### CommandGraphQlDefinition {#command-commandgraphqldefinition}

The definition of how a command should appear in the GraphQL API.

| Key             | Value                                                 | Required | Description                                                                                                            |
| --------------- | ----------------------------------------------------- | -------- | ---------------------------------------------------------------------------------------------------------------------- |
| `rootFieldName` | [GraphQlFieldName](#command-graphqlfieldname)         | true     | The name of the graphql root field to use for this command.                                                            |
| `rootFieldKind` | [GraphQlRootFieldKind](#command-graphqlrootfieldkind) | true     | Whether to put this command in the Query or Mutation root of the GraphQL API.                                          |
| `deprecated`    | [Deprecated](#command-deprecated) / null              | false    | Whether this command root field is deprecated. If set, this will be added to the graphql schema as a deprecated field. |

**Example:**

```yaml
rootFieldName: getLatestArticle
rootFieldKind: Query
```

#### Deprecated {#command-deprecated}

OpenDd configuration to indicate whether an object type field, relationship, model root field or command root field is
deprecated.

| Key      | Value         | Required | Description                 |
| -------- | ------------- | -------- | --------------------------- |
| `reason` | string / null | false    | The reason for deprecation. |

#### GraphQlRootFieldKind {#command-graphqlrootfieldkind}

Whether to put this command in the Query or Mutation root of the GraphQL API.

**Value:** `Query` / `Mutation`

#### GraphQlFieldName {#command-graphqlfieldname}

The name of a GraphQL object field.

**Value:** string

#### CommandSource {#command-commandsource}

Description of how a command maps to a particular data connector

| Key                    | Value                                                 | Required | Description                                                                                 |
| ---------------------- | ----------------------------------------------------- | -------- | ------------------------------------------------------------------------------------------- |
| `dataConnectorName`    | [DataConnectorName](#command-dataconnectorname)       | true     | The name of the data connector backing this command.                                        |
| `dataConnectorCommand` | [DataConnectorCommand](#command-dataconnectorcommand) | true     | The function/procedure in the data connector that backs this command.                       |
| `argumentMapping`      | [ArgumentMapping](#command-argumentmapping)           | false    | Mapping from command argument names to data connector function or procedure argument names. |

**Example:**

```yaml
dataConnectorName: data_connector
dataConnectorCommand:
  function: latest_article
argumentMapping: {}
```

#### ArgumentMapping {#command-argumentmapping}

Mapping of a comand or model argument name to the corresponding argument name used in the data connector. The key of
this object is the argument name used in the command or model and the value is the argument name used in the data
connector.

| Key           | Value                                                           | Required | Description                                             |
| ------------- | --------------------------------------------------------------- | -------- | ------------------------------------------------------- |
| `<customKey>` | [DataConnectorArgumentName](#command-dataconnectorargumentname) | false    | The name of an argument as defined by a data connector. |

#### DataConnectorArgumentName {#command-dataconnectorargumentname}

The name of an argument as defined by a data connector.

**Value:** string

#### DataConnectorCommand {#command-dataconnectorcommand}

The function/procedure in the data connector that backs this command.

**Must have exactly one of the following fields:**

| Key         | Value                                   | Required | Description                                  |
| ----------- | --------------------------------------- | -------- | -------------------------------------------- |
| `function`  | [FunctionName](#command-functionname)   | false    | The name of a function backing the command.  |
| `procedure` | [ProcedureName](#command-procedurename) | false    | The name of a procedure backing the command. |

#### ProcedureName {#command-procedurename}

The name of a procedure backing the command.

**Value:** string

#### FunctionName {#command-functionname}

The name of a function backing the command.

**Value:** string

#### DataConnectorName {#command-dataconnectorname}

The name of a data connector.

**Value:** string

#### ArgumentDefinition {#command-argumentdefinition}

The definition of an argument for a field, command, or model.

| Key           | Value                                   | Required | Description              |
| ------------- | --------------------------------------- | -------- | ------------------------ |
| `name`        | [ArgumentName](#command-argumentname)   | true     | The name of an argument. |
| `type`        | [TypeReference](#command-typereference) | true     |                          |
| `description` | string / null                           | false    |                          |

#### ArgumentName {#command-argumentname}

The name of an argument.

**Value:** string

#### TypeReference {#command-typereference}

A reference to an Open DD type including nullable values and arrays. Suffix '!' to indicate a non-nullable reference,
and wrap in '[]' to indicate an array. Eg: '[String!]!' is a non-nullable array of non-nullable strings.

**Value:** string

#### CommandName {#command-commandname}

The name of a command.

**Value:** string
