---
sidebar_position: 6
sidebar_label: Permissions
description: "Learn how to define permissions, access control or authorization rules on output types, models and
commands in Hasura's OpenDD Spec. Useful for managing roles and accessibility."
toc_max_heading_level: 4
keywords:
  - hasura
  - permissions
  - openDD spec
  - access control
  - authorization
  - roles and permissions
  - model select permissions
  - command permissions
  - type output permissions
seoFrontMatterUpdated: true
---

# OpenDD Permissions

## Introduction

The OpenDD Spec lets you define permissions, (also known as access control or authorization rules) on
[output types](./types.mdx), [models](./models.mdx) and [commands](./commands.mdx) in your data domain.

The following types of permissions can be defined in the [OpenDD spec](/data-domain-modeling/overview.mdx):

- `TypePermissions` define which fields are allowed to be accessed by a role. Defining permissions on output types
  is useful, as multiple models can return the same output type.
- `ModelPermissions` define which objects or rows within a model are allowed to be accessed by a role.
- `CommandPermissions` defines which commands are allowed to be executed by a role.

## Type permissions {#type-permissions}

A type permission will need the type and the role(s) for which the permission should be defined. For each role,
you will need to define the fields accessible for that role.

### Metadata Structure

```yaml
kind: TypePermissions
version: v1
definition:
  typeName: <TypeName>
  permissions: <TypePermission>
```

| Field         | Type                                          | Required | Description                                                   |
| ------------- | --------------------------------------------- | -------- | ------------------------------------------------------------- |
| `typeName`    | [`TypeName`](/data-domain-modeling/types.mdx) | true     | The name of the type for which permissions are to be defined. |
| `permissions` | [`[TypePermission]`](#typepermission)         | true     | The permissions object for this type, one for each role.      |

#### TypePermission

```yaml
permissions:
  - role: <RoleName>
    output: <OutputPermission>
```

| Field      | Type                                            | Required | Description                                                   |
| ---------- | ----------------------------------------------- | -------- | ------------------------------------------------------------- |
| `role`     | `String`                                        | true     | The name of the role for which permissions are to be defined. |
| `output`   | [`OutputPermission`](#outputpermission)         | true     | The type output permission for the role.                      |

#### OutputPermission

```yaml
output:
  allowedFields:
  - <field1>
  - <field2>
```

| Field           | Type       | Required | Description                                     |
| --------------- | ---------- | -------- | ----------------------------------------------- |
| `allowedFields` | `[String]` | true     | List of fields that are accessible to the role. |

### Examples

To define permissions on an output type `article` for `admin` and `user` role:

```yaml
kind: TypePermissions
version: v1
definition:
  typeName: article
  permissions:
  - role: admin
    output:
      allowedFields:
      - id
      - title
      - author_id
  - role: user
    output:
      allowedFields:
      - id
      - title
```

:::info Types are inaccessible when undefined for a role

If a role doesn't define any permissions for this type, then it won't be accessible to that role.

:::

## Model Permissions {#model-permissions}

A model permission will need the model name and the role(s) for which the permission should be defined. For each
role, you will need to define an optional filter expression. Objects (or rows/documents) that satisfy this filter
predicate will be returned for that role.

### Metadata Structure

```yaml
kind: ModelPermissions
version: v1
definition:
  modelName: <ModelName>
  permissions: <ModelPermission>
```

| Field       | Type                                    | Required | Description                                                    |
| ----------- | --------------------------------------- | -------- | -------------------------------------------------------------- |
| modelName   | `String`                                | true     | The name of the model for which permissions are to be defined. |
| permissions | [`[ModelPermission]`](#modelpermission) | true     | The permissions object for this model, one for each role.      |

#### ModelPermission

```yaml
permissions:
  - role: <RoleName>
    select: <SelectPermission>
```

| Field      | Type                                    | Required | Description                                                   |
| ---------- | --------------------------------------- | -------- | ------------------------------------------------------------- |
| `role`     | `String`                                | true     | The name of the role for which permissions are to be defined. |
| `select`   | [`SelectPermission`](#selectpermission) | true     | The model select permission for the role.                     |

#### SelectPermission

```yaml
select:
  filter: <ModelPredicate>
```

| Field  | Type             | Required | Description                                                                                                                                                                                                                                                                                                                    |
| ------ | ---------------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| filter | `ModelPredicate` | false    | Optional predicate to satisfy. This predicate can use operators supported by the modelâ€™s data connector. If the filter is missing then all rows are returned. If the filter is present, then only the rows satisfying this filter expression are returned. (Reference of [ModelPredicate](./common-syntax.mdx#modelpredicate)) |

### Examples

Below, we're creating a set of `ModelPermissions` on the `Articles` model for the roles `admin`, `user_1`, and `user_2`.

As the `select` object for `admin` role is empty, it will return all rows.

The `user_1` role's `select` object has a filter predicate that will return rows where the `author_id` field is equal to
the `x-hasura-user-id` session variable.

The `user_2` role's `select` object has a filter predicate that will return rows where the `title` field is like the
string `Functional`.

```yaml
kind: ModelPermissions
version: v1
definition:
  modelName: Articles
  permissions:
  - role: admin
    select:
      filter:
  - role: user_1
    select:
      filter:
        fieldComparison:
          field: author_id
          operator: _eq
          value:
            sessionVariable: x-hasura-user-id
  - role: user_2
    select:
      filter:
        and:
        - fieldComparison:
            field: title
            operator: _like
            value:
              literal: "%Functional%"
```

## Command permissions {#command-permissions}

A command permission will need the command name and the role(s) for which the permission should be defined.

### Metadata structure

```yaml
kind: CommandPermissions
version: v1
definition:
  commandName: <CommandName>
  permissions: <CommandPermission>
```

| Field         | Type                                        | Required | Description                                                      |
| ------------- | ------------------------------------------- | -------- | ---------------------------------------------------------------- |
| `commandName` | `String`                                    | true     | The name of the command for which permissions are to be defined. |
| `permissions` | [`[CommandPermission]`](#commandpermission) | true     | The permissions object for this command, one for each role.      |

#### CommandPermission

```yaml
permissions:
  - role: <RoleName>
    allowExecution: <Boolean>
```

| Field            | Type      | Required | Description                                                   |
| ---------------- | --------- | -------- | ------------------------------------------------------------- |
| `role`           | `String`  | true     | The name of the role for which permissions are to be defined. |
| `allowExecution` | `Boolean` | true     | Is the execution of the command allowed for the role          |

### Examples

To define permissions on a command with name `get_article_by_id` for `admin` and `user` role:

```yaml
kind: CommandPermissions
version: v1
definition:
  commandName: get_article_by_id
  permissions:
  - role: admin
    allowExecution: true
  - role: user
    allowExecution: false
```

If a role doesn't define any permissions for this type, then it won't be accessible to that role.
