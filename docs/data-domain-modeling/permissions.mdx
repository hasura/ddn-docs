---
sidebar_position: 7
sidebar_label: Permissions
description: Hasura Data Domain Permissions
keywords:
  - hasura
  - data
  - data domain specification
  - dds
  - permissions
  - access control
  - authorization
  - rbac
---

# Hasura Data Domain Permissions

## Introduction

Hasura DDN lets you define permissions, (also known as access control or authorization rules) on [models](./models.mdx)
and [output types](./types.mdx) on your data domain.

Permissions in an API are essential for ensuring data security and maintaining resource integrity. They restrict access
to sensitive data and operations to authorized users, reducing the risk of unauthorized or malicious activity and are
important for compliance with legal and regulatory standards.

The following types of permissions are defined in the OpenDD spec:

- `typeOutputPermissions` define which fields are allowed to be accessed by a role. Defining permissions on output types
  is useful, as multiple models can return the same output type.
- `modelSelectPermissions` define which objects or rows within the model are allowed to be accessed by a role.
- `commandPermissions` defines which commands are allowed to be executed by a role.

## Output Type Permissions

An Output Type Permission will need the type and the role(s) for which the permission should be defined. For each role,
you will need to define the fields accessible for that role.

### Metadata Structure

```json
{
  "kind": "TypeOutputPermissions",
  "typeName": "<TypeName>",
  "permissions": {
    "<RoleName>": {
      "fields": ["field1", "field2"]
    }
  }
}
```

| Field       | Type                                 | Required | Description                                                                                                                    |
| ----------- | ------------------------------------ | -------- | ------------------------------------------------------------------------------------------------------------------------------ |
| typeName    | `String`                             | true     | Name of the output type on which permissions are to be defined.                                                                |
| permissions | `{"<RoleName>": <OutputPermission>}` | true     | The permissions object for this type. Each key of the object is a role, and the value is an object of type `OutputPermission`. |

Note: `RoleName` is the role in `String`.

#### OutputPermission

| Field  | Type       | Required | Description                                                        |
| ------ | ---------- | -------- | ------------------------------------------------------------------ |
| fields | `[String]` | true     | List of field names (of the type) that are accessible to the role. |

### Examples

To define permissions on an output type `article` for `admin` and `user` role -

```json
{
  "kind": "TypeOutputPermissions",
  "typeName": "article",
  "permissions": {
    "admin": {
      "fields": ["id", "title", "author_id"]
    },
    "user": {
      "fields": ["id", "title"]
    }
  }
}
```

If a role doesn't define any permissions for this type, then it won't be accessible to that role.

## Model Select Permissions

A Model Select Permission will need the model name and the role(s) for which the permission should be defined. For each
role, you will need to define an optional filter expression. Objects (or rows/documents) that satisfy this filter
predicate will be returned for that role.

### Metadata Structure

```json
{
  "kind": "ModelSelectPermissions",
  "modelName": "<ModelName>",
  "permissions": {
    "<RoleName>": {
      "filter": <ModelPredicate>
    },
    "<RoleName>": {
      "filter": <ModelPredicate>
    }
  }
}
```

| Field       | Type                                 | Required | Description                                                                                                                    |
| ----------- | ------------------------------------ | -------- | ------------------------------------------------------------------------------------------------------------------------------ |
| modelName   | `String`                             | true     | Name of the model on which permissions are to be defined.                                                                      |
| permissions | `{"<RoleName>": <SelectPermission>}` | true     | The permissions object for this type. Each key of the object is a role, and the value is an object of type `SelectPermission`. |

Note: `RoleName` is the role in `String`.

#### SelectPermission

| Field  | Type             | Required | Description                                                                                                                                                                                                                                                                                                                 |
| ------ | ---------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| filter | `ModelPredicate` | false    | Optional predicate to satisfy. This predicate can use operators supported by the modelâ€™s data source. If the filter is missing then all rows are returned. If the filter is present, then only the rows satisfying this filter expression are returned. (Reference of [ModelPredicate](./common-syntax.mdx#modelpredicate)) |

### Examples

```json
{
  "kind": "ModelSelectPermissions",
  "modelName": "Articles",
  "permissions": {
    "admin": {},
    "user_1": {
      "filter": {
        "fieldComparison": {
          "field": "author_id",
          "operator": "_eq",
          "value": {
            "sessionVariable": "x-hasura-user-id"
          }
        }
      }
    },
    "user_2": {
      "filter": {
        "and": [
          {
            "fieldComparison": {
              "field": "title",
              "operator": "like",
              "value": {
                "literal": "Functional"
              }
            }
          }
        ]
      }
    }
  }
}
```

## Command Permissions

A Command Permissions will need the command name and the role(s) for which the permission should be defined.

### Metadata Structure

```json
{
  "kind": "CommandPermissions",
  "commandName": "<CommandName>",
  "permissions": {
    "<RoleName>": {
      "allowExecution": "<Boolean>"
    }
  }
}
```

| Field       | Type                                  | Required | Description                                                                                                                        |
| ----------- | ------------------------------------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| commandName | `String`                              | true     | Name of the command for which permissions are to be defined.                                                                       |
| permissions | `{"<RoleName>": <CommandPermission>}` | true     | The permissions object for this command. Each key of the object is a role, and the value is an object of type `CommandPermission`. |

Note: `RoleName` is the role in `String`.

#### CommandPermission

| Field           | Type      | Required | Description                                          |
| --------------- | --------- | -------- | ---------------------------------------------------- |
| allow_execution | `Boolean` | true     | Is the execution of the command allowed for the role |

### Examples

To define permissions on a command with name `get_article_by_id` for `admin` and `user` role -

```json
{
  "kind": "CommandPermissions",
  "commandName": "get_latest_article_id",
  "permissions": {
    "admin": {
      "allowExecution": true
    },
    "user": {
      "allowExecution": false
    }
  }
}
```

If a role doesn't define any permissions for this type, then it won't be accessible to that role.
