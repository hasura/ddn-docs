---
sidebar_position: 3
sidebar_label: Data Source
description: Hasura Data Domain Specification for Data Source
keywords:
  - hasura
  - data
  - data domain specification
  - dds
  - datasource
---

# Hasura Data Domain Specification Data Source

## Introduction

A Data Source is a way to specify where your data comes from and how it can be used. It can connect to various types of
data, like SQL databases, NoSQL databases, REST APIs, GraphQL APIs, files, and more.

A Data Source includes two main things: a connector URL (the link to your data) and the data structure it understands
(schema).

In the Open Data Domain Specification (OpenDD Spec), every DataSource must have a connector URL and a schema. This
schema defines how the data is structured and how the data source can respond to commands.

Once you've declared a Data Source, you can use it in your `Model`'s configuration by
[referencing it with the source](../models/#source) property, connecting your model to your chosen data source.

## Description

To create a model, start by defining an OpenDD object with the "kind" set to "DataSource". This object should include
three main fields: `name`, `data_connector_url`, and `schema`.

```json
{
  "kind": "DataSource",
  "name": "<DataSourceName>",
  "data_connector_url": "<DataConnectorURL>",
  "schema": "<SchemaResponse>"
}
```

| Field              | Type     | Required | Description                                                                                                            |
| ------------------ | -------- | -------- | ---------------------------------------------------------------------------------------------------------------------- |
| name               | `String` | true     | Name of the Data Source.                                                                                               |
| data_connector_url | `String` | true     | URL to access the data source connector.                                                                               |
| schema             | `Object` | true     | The schema response from the data connector- includes scalar_types, object_type, collections, functions and procedures |

## Schema

Schema Response is an object that defines the schema of the data source. It has the following fields:

```json
{
  "scalar_types": "<String, ScalarTypeDefinition>",
  "object_types": "<String, ObjectTypeDefinition>",
  "collections": "<Collections>",
  "functions": "<Functions>",
  "procedures": "<Procedures>"
}
```

| Field        | Type     | Required | Description                                                                |
| ------------ | -------- | -------- | -------------------------------------------------------------------------- |
| scalar_types | `Object` | true     | Supported scalar types, with definitions for aggregate functions and more. |
| object_types | `Object` | true     | Supported object types with their definitions.                             |
| collections  | `Array`  | true     | Collections in the schema.                                                 |
| functions    | `Array`  | true     | Functions in the schema.                                                   |
| procedures   | `Array`  | true     | Procedures in the schema.                                                  |

### Scalar Type

This field is to represent the behaviour of the scalar types in the schema. The behaviour definition will include
aggregate_functions, comparison_operators and update_operators.

It has can be denoted as:

```json
{
  "<ScalarTypeName>": {
    "aggregate_functions": "<String, AggregateFunctionDefinition>",
    "comparison_operators": "<String, ComparisonOperatorDefinition>",
    "update_operators": "<String, UpdateOperatorDefinition>"
  }
}
```

#### AggregateFunctionDefinition

This field defines How the aggregate function will behave. The definition of the aggregate function has the following
fields:

```json
{
  "result_type": "<TypeDefinition>"
}
```

| Field       | Type     | Required | Description                                |
| ----------- | -------- | -------- | ------------------------------------------ |
| result_type | `Object` | true     | The result type of the aggregate function. |

The result type can be a named type, nullable type, or an Array type as defined in the [Type definition](#type).

#### ComparisonOperatorDefinition

This field defines How the comparison operator will behave. The definition of the comparison operator has the following
fields:

```json
{
  "argument_type": "<TypeDefinition>"
}
```

| Field         | Type     | Required | Description                                   |
| ------------- | -------- | -------- | --------------------------------------------- |
| argument_type | `Object` | true     | The argument type of the comparison operator. |

The argument type can be a named type, nullable type, or an Array type as defined in the [Type definition](#type).

#### UpdateOperatorDefinition

This field defines How the update operator will behave. The definition of the update operator has the following fields:

```json
{
  "argument_type": "<TypeDefinition>"
}
```

| Field         | Type     | Required | Description                               |
| ------------- | -------- | -------- | ----------------------------------------- |
| argument_type | `Object` | true     | The argument type of the update operator. |

The argument type can be a named type, nullable type, or an Array type as defined in the [Type definition](#type).

#### Field Definition

This field defines the behaviour of the field in the object type. The definition of the field has the following fields:

```json
{
  "description": "<String>",
  "arguments": "<String, ArgumentDefinition>",
  "type": "<TypeDefinition>"
}
```

| Field       | Type     | Required | Description                                     |
| ----------- | -------- | -------- | ----------------------------------------------- |
| description | `String` | true     | Description of the field.                       |
| arguments   | `Object` | true     | [Arguments](#argument-definition) of the field. |
| type        | `Object` | true     | The [Type definition](#type) of the field.      |

### Object Type

This field is to represent the behaviour of the object types in the schema. The behaviour definition will include fields
( with their definitions). It can be denoted as:

```json
{
  "<ObjectTypeName>": {
    "description": "<String>",
    "fields": "<String, FieldDefinition>"
  }
}
```

### Collections

This field is to represent the behaviour of the collections in the schema. The behaviour definition will include fields
( with their definitions). It can be denoted as:

```json
[
  {
    "name": "<String>", // Eg. Articles
    "description": "!<String>",
    "arguments": "<String, ArgumentDefinition>",
    "type": "<String>", // Eg. article
    "insertable_columns": "![String]",
    "updatable_columns": "![String]",
    "deletable": "<Boolean>",
    "uniqueness_constraints": "<String, UniquenessConstraintDefinition>",
    "foreign_keys": "<String, ForeignKeyDefinition>"
  }
]
```

| Field                  | Type     | Required | Description                                          |
| ---------------------- | -------- | -------- | ---------------------------------------------------- |
| name                   | `String` | true     | Name of the collection.                              |
| description            | `String` | false    | Description of the collection.                       |
| arguments              | `Object` | true     | [Arguments](#argument-definition) of the collection. |
| type                   | `String` | true     | The type name of the collection.                     |
| deletable              | `String` | true     | Whether the collection is deletable.                 |
| insertable_columns     | `Array`  | false    | Insertable column names of the collection            |
| updatable_columns      | `Array`  | false    | Updatable column names of the collection.            |
| uniqueness_constraints | `Object` | true     | Uniqueness constraints of the collection.            |
| foreign_keys           | `Object` | true     | Foreign keys of the collection.                      |

The arguments can be type with a description as defined in the [Argument Definition](#argument-definition).

#### Uniqueness Constraint Definition

This field defines the behaviour of the uniqueness constraint in the collection. The definition of the uniqueness
constraint has the following fields:

```json
{
  "unique_columns": "<Array>"
}
```

#### ForeignKeyDefinition

This field defines the available foreign keys in the collection. The definition of the foreign key has the following
fields:

```json
{
  "column_mapping": "<String, String>",
  "foreign_collection": "<String>"
}
```

| Field              | Type     | Required | Description                               |
| ------------------ | -------- | -------- | ----------------------------------------- |
| column_mapping     | `Object` | true     | Column mapping of the foreign key.        |
| foreign_collection | `String` | true     | The foreign collection of the foreign key |

### Functions

A function can be collections which return a single column and row. This field `functions` is to represent the available
functions on a data source in the form of an array. A function can be denoted as:

```json
[
  {
    "name": "<String>",
    "description": "!<String>",
    "arguments": "<String, ArgumentDefinition>",
    "result_type": "<TypeDefinition>"
  }
]
```

| Field       | Type     | Required | Description                                     |
| ----------- | -------- | -------- | ----------------------------------------------- |
| name        | `String` | true     | Name of the function.                           |
| description | `String` | false    | Description of the field.                       |
| arguments   | `Object` | true     | [Arguments](#argument-definition) of the field. |
| result_type | `Object` | true     | The [Type definition](#type) of the field.      |

### Procedures

A procedure can be collections which return multiple columns and rows. This field `procedures` is to represent the
available procedures on a data source in the form of an array. A procedure can be denoted as:

```json
[
  {
    "name": "<String>",
    "description": "!<String>",
    "arguments": "<String, ArgumentDefinition>",
    "result_type": "<TypeDefinition>"
  }
]
```

| Field       | Type     | Required | Description                                     |
| ----------- | -------- | -------- | ----------------------------------------------- |
| name        | `String` | true     | Name of the procedure.                          |
| description | `String` | false    | Description of the field.                       |
| arguments   | `Object` | true     | [Arguments](#argument-definition) of the field. |
| result_type | `Object` | true     | The [Type definition](#type) of the field.      |

### Common Definitions

Some of the items mentioned above rely on common concepts for defining data shapes, including type definitions and
argument definitions. These concepts are explained below

#### Type

In the schema definition context, Types are the valid representations of values as JSON. A type can be a named type,
nullable type, or an Array type.

:::info

Note: The term 'Types' mentioned here does not refer to the OpenDDS 'Type.' Instead, it solely defines an atomic shape
of a value that a data source can offer.

:::

##### Named Type

Most atomic types are named types. A named type is a type that has a name.

```json
{
  "type": "named",
  "name": "<String>"
}
```

##### Nullable Type

A nullable type is a type that can be null or the underlying type (a named type). It can be thought of as a wrapper type
that enabled nullable charactaristics on an underlying type. It can be denotd as:

```json
{
  "type": "nullable",
  "underlying_type": "<TypeDefinition>" // named type definition
}
```

##### Array Type

An array type is a type that is an array of the underlying type (a named type). It can be thought of as a wrapper type.
It can be denotd as:

```json
{
  "type": "array",
  "underlying_type": "<TypeDefinition>" // named type definition
}
```

#### Argument Definition

This field defines the behaviour of the argument in the field. The definition of the argument has the following fields:

```json
{
  "description": "<String>",
  "type": "<TypeDefinition>"
}
```

| Field       | Type     | Required | Description                  |
| ----------- | -------- | -------- | ---------------------------- |
| description | `String` | true     | Description of the argument. |
| type        | `Object` | true     | The type of the argument.    |

The type can be a named type, nullable type, or an Array type as defined in the [Type definition](#type).

## Examples

Following is an example of a complete Data Source definition as a OpenDDS object.

```json
    {
        "kind": "DataSource",
        "name": "db",
        "dataConnectorUrl": "http://reference_agent:8100",
        "schema": {
            "scalar_types": {
                "Int": {
                    "aggregate_functions": {
                        "max": {
                            "result_type": {
                                "type": "nullable",
                                "underlying_type": {
                                    "type": "named",
                                    "name": "Int"
                                }
                            }
                        },
                        "min": {
                            "result_type": {
                                "type": "nullable",
                                "underlying_type": {
                                    "type": "named",
                                    "name": "Int"
                                }
                            }
                        }
                    },
                    "comparison_operators": {},
                    "update_operators": {}
                },
                "String": {
                    "aggregate_functions": {},
                    "comparison_operators": {
                        "like": {
                            "argument_type": {
                                "type": "named",
                                "name": "String"
                            }
                        }
                    },
                    "update_operators": {}
                }
            },
            "object_types": {
                "article": {
                    "description": "An article",
                    "fields": {
                        "id": {
                            "description": "The article's primary key",
                            "arguments": {},
                            "type": {
                                "type": "named",
                                "name": "Int"
                            }
                        },
                        "title": {
                            "description": "The article's title",
                            "arguments": {},
                            "type": {
                                "type": "named",
                                "name": "String"
                            }
                        },
                        "author_id": {
                            "description": "The article's author ID",
                            "arguments": {},
                            "type": {
                                "type": "named",
                                "name": "Int"
                            }
                        }
                    }
                },
                "author": {
                    "description": "An author",
                    "fields": {
                        "last_name": {
                            "description": "The author's last name",
                            "arguments": {},
                            "type": {
                                "type": "named",
                                "name": "String"
                            }
                        },
                        "first_name": {
                            "description": "The author's first name",
                            "arguments": {},
                            "type": {
                                "type": "named",
                                "name": "String"
                            }
                        },
                        "id": {
                            "description": "The author's primary key",
                            "arguments": {},
                            "type": {
                                "type": "named",
                                "name": "Int"
                            }
                        }
                    }
                }
            },
            "collections": [
                {
                    "name": "articles",
                    "description": "A collection of articles",
                    "arguments": {},
                    "type": "article",
                    "deletable": false,
                    "uniqueness_constraints": {
                        "ArticleByID": {
                            "unique_columns": [
                                "id"
                            ]
                        }
                    },
                    "foreign_keys": {}
                },
                {
                    "name": "authors",
                    "description": "A collection of authors",
                    "arguments": {},
                    "type": "author",
                    "deletable": false,
                    "uniqueness_constraints": {
                        "AuthorByID": {
                            "unique_columns": [
                                "id"
                            ]
                        }
                    },
                    "foreign_keys": {}
                },
                {
                    "name": "articles_by_author",
                    "description": "Articles parameterized by author",
                    "arguments": {
                        "author_id": {
                            "type": {
                                "type": "named",
                                "name": "Int"
                            }
                        }
                    },
                    "type": "article",
                    "deletable": false,
                    "uniqueness_constraints": {},
                    "foreign_keys": {}
                }
            ],
            "functions": [
                {
                    "name": "latest_article_id",
                    "description": "Get the ID of the most recent article",
                    "arguments": {},
                    "result_type": {
                        "type": "nullable",
                        "underlying_type": {
                            "type": "named",
                            "name": "Int"
                        }
                    }
                },
                {
                    "name": "latest_article",
                    "description": "Get the most recent article",
                    "arguments": {},
                    "result_type": {
                        "type": "nullable",
                        "underlying_type": {
                            "type": "named",
                            "name": "article"
                        }
                    }
                },
                {
                    "name": "get_article_by_id",
                    "description": "Insert or update an article",
                    "arguments": {
                        "id": {
                            "description": "the id of the article to fetch",
                            "type": {
                                "type": "named",
                                "name": "Int"
                            }
                        }
                    },
                    "result_type": {
                        "type": "nullable",
                        "underlying_type": {
                            "type": "named",
                            "name": "article"
                        }
                    }
                }
            ],
            "procedures": [
                {
                    "name": "upsert_article",
                    "description": "Insert or update an article",
                    "arguments": {
                        "article": {
                            "description": "The article to insert or update",
                            "type": {
                                "type": "named",
                                "name": "article"
                            }
                        }
                    },
                    "result_type": {
                        "type": "nullable",
                        "underlying_type": {
                            "type": "named",
                            "name": "article"
                        }
                    }
                },
                {
                    "name": "update_article_title_by_id",
                    "description": "Update an article title given the ID and new title",
                    "arguments": {
                        "id": {
                            "description": "the id of the article to update",
                            "type": {
                                "type": "named",
                                "name": "Int"
                            }
                        },
                        "title": {
                            "description": "the new title of the article",
                            "type": {
                                "type": "named",
                                "name": "String"
                            }
                        }
                    },
                    "result_type": {
                        "type": "nullable",
                        "underlying_type": {
                            "type": "named",
                            "name": "article"
                        }
                    }
                }
            ]
        }
    },

```
