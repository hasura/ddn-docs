---
sidebar_position: 6
sidebar_label: Commands
description: Learn how to utilize Hasura Data Domain Specification commands to execute business logic directly from your GraphQL API.
toc_max_heading_level: 4
keywords:
  - hasura commands
  - hasura dds commands
  - graphql api enforcement
  - back-end business logic
  - hasura function
  - datasources in hasura
  - hasura metadata structure
  - rest endpoint
  - custom server
  - serverless function
seoFrontMatterUpdated: true
---

# OpenDD Commands

## Introduction

Commands are backed by **functions** or **procedures** declared in a `DataSource` allowing you to execute business logic
directly from your GraphQL API. You can use them to validate, process, or enrich some data, call another API, or log a
user in. As an example, with commands you can connect to a REST endpoint which can be your own custom server, a public
API, or a serverless function.

To create a command, you need to define an OpenDD object with `"kind": "Command"`, which has both `name` and
`outputType` fields.

### Metadata structure

```json
{
  "kind": "Command",
  "name": "<String>",
  "arguments": <ArgumentDefinition>,
  "outputType": "<String>",
  "source": <CommandSourceConfiguration>,
  "graphql": <GraphQLConfiguration>
}
```

| Field        | Type                                                        | Required | Description                                            |
|--------------|-------------------------------------------------------------|----------|--------------------------------------------------------|
| `name`       | `String`                                                    | true     | Name of the command.                                   |
| `arguments`  | [`[ArgumentDefinition]`](#argumentdefinition)               | false    | The argument definition for the command.               |
| `outputType` | `String`                                                    | true     | The name of the return [type](./types.mdx) of command. |
| `source`     | [`CommandSourceConfiguration`](#commandsourceconfiguration) | true     | Source configuration for the command.                  |
| `graphql`    | [`GraphQLConfiguration`](#graphqlconfiguration)             | true     | GraphQL configuration for the command.                 |

#### ArgumentDefinition {#argumentdefinition}

Arguments is a list of objects that defines the arguments for the command. An argument object has the following fields:

```json
{
  "name": "<String>",
  "type": "<Type>"
}
```

| Field  | Type     | Required | Description                                      |
| ------ | -------- | -------- | ------------------------------------------------ |
| `name` | `String` | true     | Name of the argument.                            |
| `type` | `Type`   | true     | [Type](./types.mdx) of the argument as a string. |

#### CommandSourceConfiguration {#commandsourceconfiguration}

Source is an object that defines the data source for the command. It has the following fields:

```json
{
  "DataSource": "<String>",
  // Either function OR procedure
  "function": "<String>",
  "typeMappings": "<TypeMappings>",
  "argumentMappings": "<ArgumentMappings>"
}
```

A command can either be backed by a function or a procedure.

| Field                     | Type     | Required | Description                                                                           |
|---------------------------|----------|----------|---------------------------------------------------------------------------------------|
| `DataSource`              | `String` | true     | Name of the [data source](./data-source.mdx).                                         |
| `function` or `procedure` | `String` | true     | Name of the function or procedure. One of these must be chosen.                       |
| `typeMappings`            | [`TypeMappings`](#typemappings) | false    | [Type](./types.mdx) mappings for the command.                                         |
| `argumentMappings`        | [[`ArgumentMappings`]](#argumentmappings) | false    | Argument mappings for the command. Required only if `arguments` is defined            |

:::info Functions or Procedures?

Functions are used for read operations and procedures are used for write operations.

:::

#### TypeMappings {#typemappings}

The `typemappings` are used to define the mapping between the fields of the
OpenDDS `outputType` and the fields of the `result_type` of the `function` or
`procedure`. It has the following fields:

```json
{
  "<CommandName>" : {
    "fieldMappings": "<FieldMapping>"
  }
}
```

| Field           | Type                              | Required | Description                                                                           |
|-----------------|-----------------------------------|----------|---------------------------------------------------------------------------------------|
| `CommandName`   | `String`                          | true     | Name of the command                                                                   |
| `fieldMappings` | [`FieldMapping`](#fieldmapping)   | true     | The field mapping between the fields of OpenDDS output type and the NDC result_type   |

#### FieldMapping {#fieldmapping}

The `fieldMappings` is the place where you define the mappings for the different fields of the `outputType`.

It has the following fields:

```json
{
  "<OpenDDSFieldName>": {
    "column": "<String>"
  }
}
```

| Field               | Type     | Required | Description                                                                                                      |
|---------------------|----------|----------|------------------------------------------------------------------------------------------------------------------|
| `OpenDDSFieldName`  | `String` | true     | Name of the field of the output type                                                                             |                                             
| `column`            | `String` | true     | The name of the field in the NDC `result_type` of function or procedure to which the `OpenDDSFieldName` maps to  |

#### ArgumentMappings {#argumentmappings}

The `argumentMappings` are used to define the mapping between the arguments of the OpenDDS `arguments` and the arguments of the `function` or `procedure`. It has the following fields:

```json
{
  "<OpenDDSArgumentName>": "<NDCArgumentName>"
}
```

| Field                 | Type     | Required | Description                                                                                   |
|-----------------------|----------|----------|-----------------------------------------------------------------------------------------------|
| `OpenDDSArgumentName` | `String` | true     | Name of the argument of the command                                                           |                                             
| `NDCArgumentName`     | `String` | true     | The name of the argument in function or procedure to which the `OpenDDSArgumentName` maps to  |


#### GraphQLConfiguration {#graphqlconfiguration}

GraphQL is an object that defines the GraphQL configuration for the command. It has the following fields:

```json
{
  "rootFieldName": "<String>",
  "rootFieldKind": "<String>"
}
```

| Field           | Type     | Required | Description                                  |
| --------------- | -------- | -------- | -------------------------------------------- |
| `rootFieldName` | `String` | true     | The GraphQL root field name for the command. |
| `rootFieldKind` | `String` | true     | The type of GraphQL operation (`Query`).     |

## Examples

```json
{
  "kind": "Command",
  "name": "get_article_by_id",
  "arguments": [
    {
      "name": "article_id",
      "type": "Int"
    }
  ],
  "outputType": "commandArticle",
  "source": {
    "dataSource": "db",
    "function": "get_article_by_id",
    "typeMappings": {
      "commandArticle": {
        "fieldMappings": {
          "article_id": {
            "column": "id"
          },
          "title": {
            "column": "title"
          },
          "author_id": {
            "column": "author_id"
          }
        }
      }
    },
    "argumentMappings": {
      "article_id": "id"
    }
  },
  "graphql": {
    "rootFieldName": "getLatestArticle",
    "rootFieldKind": "Query"
  }
}
```
