---
sidebar_position: 2
sidebar_label: Configuration
description: "Explore the comprehensive guide to configuring projects on Hasura's Data Delivery Network. Learn about build profiles, namespaces, and using Hasura CLI for efficient project management."
keywords:
  - hasura configuration
  - data delivery network
  - hasura CLI
  - metadata management
  - yaml configuration
  - project setup
  - hasura version control
  - build profiles
  - hasura namespaces
  - hasura project management
  - seoFrontMatterUpdated: true
---

# Configuration

## Introduction

Hasura v3 introduces a new configuration model for projects on the Hasura Data Delivery Network (DDN). This model relies
on three families of files:

| File type              | Description                                               |
| ---------------------- | --------------------------------------------------------- |
| `*-build-profile.yaml` | Build profiles for a project.                             |
| `hasura.yaml`          | The main configuration file and entrypoint for a project. |
| `*.hml`                | Hasura metadata files for a project.                      |

## Basic configuration

When using the [hasura3 CLI](/cli/overview.mdx) to create a new project, you'll run the following command:

```bash
hasura3 local init --dir <PROJECT_NAME>
```

This will generate a new project directory with the following structure:

```bash
<PROJECT_NAME>
├── build-profile.yaml
├── hasura.yaml
├── metadata.hml
```

### build-profile.yaml

By default, your `build-profile.yaml` is populated with the following content:

```yaml
version: 1
spec:
  environment: default

  # Namespaces can be used to group certain objects of your metadata
  # in a way that makes sense for you and your team
  # You can have multiple HML files belong to a namespace
  # and you can have multiple namespaces in a project
  # We have created a `default` namespace for you, and added a HML file to it to get you started
  # Please note that `default` is a special namespace that is created for every project
  # and it cannot be deleted
  namespaces:
    - name: default
      resources:
        - ./metadata.hml
```

Here, you can see that the `build-profile.yaml` file contains a `version` and a `spec` section. The `version` section is
used to specify the version of the build profile. The `spec` section is used to specify the build profile configuration.

The `spec` section contains the following fields:

| Field         | Description                                                                  |
| ------------- | ---------------------------------------------------------------------------- |
| `environment` | The environment to use for the build.                                        |
| `namespaces`  | A list of namespaces to use for the build. Each namespace contains resources |

This tells Hasura DDN to use the `default` namespace and the `metadata.hml` file to build your project.

### hasura.yaml

By default, your `hasura.yaml` is populated with the following content:

```yaml
version: 1
project: # Your project ID here

# A build profile specifies your projects environment
# and the association of namespaces to HML files
# You can create different build profiles for different environments,
# like production and staging, which may reference environment specific auth configs
# We have created one for you to get you started
buildProfiles:
  - build-profile.yaml

# Default build profile refers to build profile
# that is used when you create a build and don't specify the build profile
defaultBuildProfile: build-profile.yaml
```

You can see that the `hasura.yaml` file contains a `version` and a `project` section. The `version` section is used to
specify the version of the configuration file. The `project` section is used to specify the project ID.

:::info Where's my project ID?

Each local project requires a companion project on the Hasura DDN. When you
[create a DDN project](/cli/commands/cloud-project-create.mdx) using the CLI, it will return the project ID.

:::

The `hasura.yaml` file also contains a `buildProfiles` section. This section is used to specify the build profiles
associated with the project. As you can see from this example, we only have one build profile, `build-profile.yaml`
which is also identified as the default to use when creating a new build. **At least one build profile is required for a
project.**

### metadata.hml

By default, your `metadata.hml` is populated with the following content:

```yaml
kind: CompatibilityConfig
date: 2023-10-19
---
kind: AuthConfig
version: v1
definition:
  allowRoleEmulationBy: admin
  mode:
    webhook:
      method: Post
      url: https://auth.pro.hasura.io/webhook/ddn?role=admin
```

`hml` is a new file format for Hasura metadata. It is a superset of the existing `yaml` format, and is designed to
provide a more flexible and extensible way to define metadata. You can leverage the power of the
[Hasura VS Code extension](https://marketplace.visualstudio.com/items?itemName=HasuraHQ.hasura) to quickly and easily
author `hml` files.

Your `hml` file contain a list of metadata objects according to the OpenDD spec. In the example above, we could add a
`HasuraHubDataConnector` object to connect to a data source. Then, import our tables as models and create a build on
Hasura DDN.

However, in the next section, we'll look at how to use namespaces to organize metadata and break up our `hml` file into
smaller, more governable pieces.

## Advanced configuration

Let's consider a data supergraph which has multiple teams collaborating on it. Each team has their own set of data
sources. We can use namespaces to organize our metadata and break up our `hml` file into smaller, more governable
pieces. We can also utilize build profiles to create different builds for different environments.

Imagine this file structure:

```bash
├── Config
│   └── config.hml
├── Subgraph1
│   ├── metadata1.hml
│   └── newmodel.hml
├── Subgraph2
│   └── metadata2.hml
├── build-profile.yaml
├── build-profile_staging.yaml
├── hasura.yaml
```

### Build profiles

In this example, we have two build profiles: `build-profile.yaml` and `build-profile_staging.yaml`. The
`build-profile.yaml` file contains the following content:

```yaml
version: 1
spec:
  environment: default
  namespaces:
    - name: default
      resources:
        - ./metadata.hml
```

Whereas the `build-profile_staging.yaml` file contains the following content:

```yaml
version: 1
spec:
  environment: staging
  namespaces:
    - name: subgraph1
      resources:
        - ./config/*
        - ./subgraph1/*
    - name: subgraph2
      resources:
        - ./subgraph2/*
```

While the `build-profile.yaml` file is similar to the one we saw in the previous section, the
`build-profile_staging.yaml` file is a bit more complex. It contains two namespaces: `subgraph1` and `subgraph2`.

The `subgraph1` namespace depends on resources in the `config` and `subgraph1` directories. The `subgraph2` namespace
depends only on resources in the `subgraph2` directory.

Each of these subgraphs can be owned by a different team, and they can be built and deployed independently. This
provides a great deal of flexibility and control over the development and deployment of your data supergraph.

### hasura.yaml

The `hasura.yaml` in the root of the project contains the following content:

```yaml
version: 1
project: <PROJECT_ID>
buildProfiles:
  - ./build-profile.yaml
  - ./build-profile_staging.yaml
defaultBuildProfile: build-profile_staging.yaml
```

It lets Hasura DDN know that we have two build profiles, and that the `build-profile_staging.yaml` is the default to use
when creating a new build.

### metadata.hml

In our basic example, we only had one `hml` file. With a more advanced configuration, so that we can leverage namespaces
and break apart our supergraph into team-ownable components, we have multiple `hml` files.

The contents of the `hml` files can be that of any valid OpenDD metadata object.

In the `./config` directory, we have a `config.hml` file with the following content:

```yaml
kind: CompatibilityConfig
date: 2023-10-19
---
kind: AuthConfig
version: v1
definition:
  allowRoleEmulationBy: admin
  mode:
    webhook:
      method: Post
      url: https://auth.pro.hasura.io/webhook/ddn?role=admin
```

Here, we're simply defining our `CompatibilityConfig` and `AuthConfig` objects. For us, that's using Hasura DDN's
built-in webhook for testing. However, you could replace this with your own
[webhook endpoint or JWT configuration](/auth/overview.mdx).

Between the two `Subgraph*` directories, we have three `hml` files.

We could then connect to a data source using the `HasuraHubDataConnector` object, and import our tables as models in the
`metadata1.hml` file. Then, we could create a build on Hasura DDN.

If we wanted to separate our models into a different file, we could use the `newmodel.hml` file in the `Subgraph1`

If there are multiple teams working on the same data source, we could use the `metadata2.hml` file in the `Subgraph2` to
define additional models that are owned by a different team.

## Resources

Check out [this repository](#) on GitHub for a working example of the advanced configuration described above.
