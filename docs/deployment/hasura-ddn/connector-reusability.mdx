---
sidebar_position: 3
description: "Reuse connectors across multiple subgraphs or multiple projects"
---

# Connector Reusability

## Introduction

Hasura DDN allows you to reuse the same connector deployment across multiple subgraphs, and even across multiple
projects. This pattern offers several advantages, especially in scenarios where you have multiple teams or applications
needing access to the same underlying data source, and also want to benefit from the performance advantage of having the
data connectors deployed as close to their data source as possible.

## Benefits of Connector Reusability

- **Reduced Redundancy:** Avoid deploying the same connector multiple times, saving resources and simplifying
  management.
- **Centralized Configuration:** Manage the connector's configuration (like connection strings, credentials, etc.) in a
  single place. Changes only need to be made once.
- **Simplified Deployment:** Deploy and update the connector independently of the subgraphs that use it.
- **Location Optimisation:** You can locate the connector as close to the data source as possible, this can
  significantly improve performance and reduce the costs and risks of egress.

## How it Works

If you copy across the `.env.cloud` file containing the read/write URLs and other connection information for the
connector, you can reuse the same connector across multiple subgraphs and even across multiple projects.

## Example Scenario

Let's say you have a PostgreSQL database hosted in `gcp-us-west2`. You have two teams: a "Products" team and a "Reviews"
team. Both teams need to access data from this database. Instead of deploying two separate PostgreSQL connectors, you
can deploy a single connector in `gcp-us-west2` (close to the database) and reuse it across both subgraphs.

### Step 1: Team one: build the Supergraph and Deploy the Connector

Team one, say the "Products" team, first builds their supergraph and
[deploys an instance](/deployment/hasura-ddn/deploy-to-ddn.mdx) of the `hasura/postgres` connector, for example in the
`gcp-us-west2` region with [region routing](/deployment/hasura-ddn/region-routing.mdx). Let's say the deployment results
in the following read and write URLs:

```.env
APP_MYPOSTGRES_READ_URL="https://my-postgres-connector-read.gcp-us-west2.nhost.run"
APP_MYPOSTGRES_WRITE_URL="https://my-postgres-connector-write.gcp-us-west2.nhost.run"
```

### Step 2: Team two: initialize a new connector in their local project

Team two, say the "Reviews" team, should initialize a new connector in their local project with the connection
information to the data source.

```sh
ddn connector init -i
```

This will create a new connector in the local project in the active subgraph with the connection information to the data
source. They can then also introspect and add the models, commands and relationships which they need to their subgraph.

```sh
ddn connector introspect my_connector
```

```sh
ddn connector show-resources my_connector
```

```sh
ddn connector models add "*"
ddn connector commands add "*"
ddn connector relationships add "*"
```

### Step 3: Team two: replace the connection information in the `.env.cloud` file

Team two can then replace the connection information in the `.env.cloud` file with the values for the "Products" team's
already deployed connector.

```.env
APP_MYPOSTGRES_READ_URL="https://my-postgres-connector-read.gcp-us-west2.nhost.run"
APP_MYPOSTGRES_WRITE_URL="https://my-postgres-connector-write.gcp-us-west2.nhost.run"
```

### Step 4: Team two: build the Supergraph and Deploy the Connector

Team two can then build their supergraph without building the connector and deploy the connector to their DDN project.

```sh
ddn project init
ddn supergraph build create --no-build-connectors
```

### Step 5: Repeat for other Subgraphs (and Projects)

You can repeat these steps for any other subgraphs that need access to the same PostgreSQL database.

## Considerations

- **Security:** When reusing connectors, ensure that you have appropriate permissions and access control configured.
  Each subgraph will have its own set of permissions, but they all operate through the same connector instance.

- **Versioning:** If the connector's interface changes (e.g., a new version is released), you'll need to update the
  `DataConnectorLink` object, and all subgraphs using it will be affected. Coordinate updates carefully.

- **Regionality:** Deploying the connector in a region close to your database is crucial for performance. If different
  subgraphs have different latency requirements, consider deploying separate connectors closer to their respective
  consumers.

- **Load Balancing:** If you anticipate high load from multiple subgraphs, consider whether a single connector instance
  can handle the combined traffic. Hasura DDN's data connectors are designed to scale, but monitor usage and consider
  deploying additional connector instances if needed.

- **Central point of failure:** All subgraphs (and projects) using a single connector, will be impacted if this
  connector is down.

## Summary

Connector reusability in Hasura DDN offers a powerful way to streamline data access and reduce operational overhead. By
carefully planning your connector deployments and leveraging the `DataConnectorLink` object, you can create a more
efficient and maintainable data architecture.
