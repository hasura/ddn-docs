---
sidebar_position: 2
sidebar_label: Configuration Reference
description:
  "Reference documentation for the setup process for the Hasura PostgreSQL connector, including connection URI details,
  native queries, and mutations."
keywords:
  - hasura postgresql setup
  - connector configuration
  - graphql api integration
  - database connection uri
  - native sql queries
  - graphql mutations
  - data modeling
  - api customization
  - hasura configuration guide
  - database schema management
seoFrontMatterUpdated: true
---

# Configuration Reference

:::warning Subject to change

During this active development phase, the configuration structure is subject to change.

:::

The format of the configuration data varies between versions. When a connector sub graph is added to a project, a
`schema.json` file is created in the configuration directory which describes the format of the `configuration.json`
file.

## Introduction

The configuration is a metadata object that lists all the database entities — such as tables — that the data connector
has to know about in order to serve queries. It never changes during the lifetime of the data connector service
instance. When your database schema changes you will have to update the configuration accordingly, see [updating with
introspection](#updating-with-introspection).

Below you will find information about how to work effectively with the configuration authoring tools provided by Hasura,
along with the data connector and descriptions of the meanings of each configuration field.

## Versioning policy

The data connector configuration must be tagged with a version identifier given by a string.

Versions are immutable. As the format evolves over time, any addition, removal or modification of fields will result in
a new version being made available.

Certain fields have default values. The defaults are allowed to evolve over time without requiring a version bump. We
justify this by having the tooling explcitly include the current defaults when creating a new configuration.

An instance of the PostgreSQL data connector may support multiple configuration versions simultaneously, but you should
expect that older versions will be phased out in the future.

As much as possible, any versions that introduce changes in the behavior of the data connector will do so in an opt-in
fashion. As such, we expect that upgrading the version of a configuration will be a straightforward matter assisted by
tooling.

The currently supported versions are:

- [`"version": "4"`](version-4) (current).
- [`"version": "3"`](version-3).

## Configuration workflows

The data connector provides a plugin to the hasura CLI to assist you in authoring configuration.

We provide the `ndc-postgres-cli`, which is a small executable whose, builds can be accessed
[here](https://github.com/hasura/ndc-postgres/releases/).

:::warning Current status

The intended way to commonly use this plugin is through the main `ddn` CLI.

But at the time of this writing this part of the developer experience is undergoing active development, so the exact
command invocations are likely to be different from what is described here.

Therefore this document will give workflow descriptions using the data connector CLI plugin directly. This is likely to
change in the near future. :::

### The initial configuration

Running `ndc-postgres-cli initialize` in an empty directory will produce a single file, `configuration.json`, containing
a minimal configuration which expects to be given a connection string via the environment variable `CONNECTION_URI`.

This is the same configuration you would get if you were add a new postgres data connector to a project with the `ddn`
cli.

### Updating with introspection

Whenever the schema of your database changes you will need to update your data connector configuration accordingly to
reflect those changes.

Running `ndc-postgres-cli update` in a configuration directory will do the following:

Connect to the database with the specified `connectionUri`, and then overwrite all data in the `metadata` field (except
for the native queries) based on the contents of the database and the values given in the `introspectionOptions` field.

Fill in default values for any fields absent from the configuration, as described in the
[Versioning Policy](#versioning-policy) section.

Various fields in the `introspectionOptions` object influence the outcome of the introspection process, See
[Configure options](#manually-editing).

### Upgrading the configuration format version

The ndc postgres cli plugin can assist in upgrading any supported version of a connector configuration to the latest
one.

`ndc-postgres-cli upgrade --from-dir <existing configuration dir> --to-dir <new directory>` will produce an upgraded
version of the configuration in `<existing configuration dir>` and place it in `<new directory>`.

Sometimes a configuration format upgrade will need some manual editing of the result, if the new version requires
information that cannot be derived from the previous version. This can vary from case to case, but the upgrade command
will output instructions if there are known manual changes required.

### Manually editing

There are occasions when the automatic introspection falls short of your needs. For instance, it may not detect a
particular entity type, or it may pick names according to conventions you disagree with.

If you find yourself in this situation you may still be able to bring your configuration into an acceptable state by
editing it manually. In this case you'd be well advised to keep your configuration files under version control, as
re-running the `update` command will overwrite your manually-crafted changes.

If there is a pattern to the changes you find yourself applying manually it's possible that your use case could warrant
a new `introspectionOptions` field that could integrate the pattern with the normal introspection process. Feel free to
raise a feature request issue on the [Issue Tracker][NDC Postgres Issue Tracker].

One section of the configuration that will always need manual authorship is the user-defined
[`nativeQueries`](/connectors/postgresql/native-queries/index.mdx).

[NDC Postgres Issue Tracker]: http://github.com/hasura/ndc-postgres/issues
