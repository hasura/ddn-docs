---
sidebar_position: 4
sidebar_label: Vector Search
description:
  "Vector search allows you to run vector similarity queries on your PostgreSQL database. This page explains how to
  configure vector search in Hasura using native queries."
keywords:
  - native queries
  - vector search
  - vector
  - similarity
  - neighbor
  - nearest neighbor
  - pgvector
seoFrontMatterUpdated: false
---

# Vector Search

Vector search allows you to run queries on vector types in your PostgreSQL database. This page explains how to configure
vector search in Hasura using native queries.

:::info Prerequisites

In order to run a vector search query, you need to have a PostgreSQL database with the
[`pgvector` extension](https://github.com/pgvector/pgvector) installed. You'll also need data in the database which has
been vectorized using a [model such as `word2vec`](https://www.tensorflow.org/text/tutorials/word2vec).

:::

## Example

Imagine a `products` table like the one we use in the docs-sample-app with the following columns:

| Column Name       | Type        |
| ----------------- | ----------- |
| id                | uuid        |
| name              | text        |
| description       | text        |
| price             | int4        |
| manufacturer_id   | uuid        |
| category_id       | uuid        |
| image             | text        |
| country_of_origin | text        |
| created_at        | timestamptz |
| updated_at        | timestamptz |
| vector            | vector      |

We want to run a query that finds products similar to a given query vector. The query should return the `name` and order
the results by similarity. We can do this using the `<->` operator provided by the `pgvector` extension.

### Configuration

```json
"nativeQueries": {
  "products_vector_search": {
    "sql": {
      "inline": "SELECT name FROM products ORDER BY vector <-> (SELECT vector FROM products WHERE name LIKE '%{{search_term}}%') ASC OFFSET 1"
    },
     "columns": {
      "id": {
        "name": "id",
        "type": {
          "scalarType": "uuid"
        }
      },
      "name": {
        "name": "name",
        "type": {
          "scalarType": "text"
        }
    },
    "arguments": {
      "query_vector": {
        "type": "embedding"
      }
    }
  }
}
```

This will create a query named `products_vector_search` which takes a `search_term` argument and returns the `name`
column ordered by similarity. The `similarity` column is calculated using the `<->` operator provided by the `pgvector`
extension.

### Usage

You can now run the query in your GraphQL API like so:

```graphql
query {
  products_vector_search(args: { search_term: "CLOUD" }) {
    name
  }
}
```

Which should return:

```json
{
  "data": {
    "products_vector_search": [
      {
        "name": "Dark Furry Logo Tee"
      },
      {
        "name": "The Original Tee"
      },
      {
        "name": "Tee"
      }
      {
        "name": "Sticker Sheet"
      },
      {
        "name": "Monogram Baseball Cap"
      },
      {
        "name": "Get Ship Done Mug"
      }
    ]
  }
}
```
