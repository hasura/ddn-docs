---
sidebar_position: 4
sidebar_label: Vector Search
description:
  "Vector search allows you to run vector similarity queries on your PostgreSQL database. This page explains how to
  configure vector search in Hasura using native queries."
keywords:
  - native queries
  - vector search
  - vector
  - similarity
  - neighbor
  - nearest neighbor
  - pgvector
seoFrontMatterUpdated: false
---

# Vector Search

Vector search allows you to run queries on vector types in your PostgreSQL database. This page explains how to configure
vector search in Hasura using native queries.

:::info Prerequisites

In order to run a vector search query, you need to have a PostgreSQL database with the
[`pgvector` extension](https://github.com/pgvector/pgvector) installed. You'll also need data in the database which has
been vectorized using a [model such as `word2vec`](https://www.tensorflow.org/text/tutorials/word2vec).

:::

## Example

Imagine a `products` table with the following columns:

| Column Name | Type      |
| ----------- | --------- |
| id          | uuid      |
| name        | varchar   |
| description | varchar   |
| price       | int       |
| vector      | embedding |

We want to run a query that finds the ten most similar products to a given query vector. We can do this using the `<->`
operator provided by the `pgvector` extension.

### Configuration

```json
"nativeQueries": {
  "products_vector_search": {
    "sql": {
      "inline": "SELECT id, name, description, price, vector, vector <-> {{query_vector}} AS similarity FROM products"
    },
    "columns": {
      "id": {
        "name": "id",
        "type": {
          "scalarType": "uuid"
        }
      },
      "name": {
        "name": "name",
        "type": {
          "scalarType": "varchar"
        }
      },
      "description": {
        "name": "description",
        "type": {
          "scalarType": "varchar"
        }
      },
      "price": {
        "name": "price",
        "type": {
          "scalarType": "int"
        }
      },
      "similarity": {
        "name": "similarity",
        "type": {
          "scalarType": "float8"
        }
      }
    },
    "arguments": {
      "query_vector": {
        "type": "vector"
      }
    }
  }
}
```

This will create a query named `products_vector_search` which takes a `query_vector` argument and returns the `id`,
`name`, `description`, `price`, and `similarity` columns. The `similarity` column is calculated using the `<->` operator
provided by the `pgvector` extension.

### Usage

You can now run the query in your GraphQL API like so:

```graphql
query {
  products_vector_search(
    args: { query_vector: [0.5, 0.4, -0.2, ...] }
    where: { price: { _lt: 500 } },
    order_by: { similarity: ASC },
    limit: 10
  ) {
    id
    name
    description
    price
    similarity
  }
}
```
