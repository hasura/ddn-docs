---
sidebar_position: 2
sidebar_label: Upgrade to supergraph config v2
description: "Guide to migrate local projects created by CLI versions <= 2024.06.09"
keywords:
  - hasura ddn
  - data delivery network
  - hasura cli
  - project configuration
  - hasura metadata management
  - yaml configuration
  - api development
  - hasura build profiles
  - hasura subgraphs
  - hasura project management
seoFrontMatterUpdated: true
---

import InstallTheCli from "@site/docs/_install-the-cli.mdx";

# Upgrading to supergraph config v2

## What has happened?

A new revision (**v1.0.0**) of the [DDN CLI](/cli/installation.mdx) has been released with some minor changes to the
project directory structure and CLI commands.

This page contains some information on what has changed and instructions to migrate your existing local projects.

## What has changed?

- The `Supergraph` object is upgraded from `v1` to `v2`.
- A `Subgraph` object is introduced to define how to build a subgraph.
- The `--subgraph` flag in DDN CLI commands now accepts a path to a subgraph config file as opposed to the subgraph name.
- The `AuthConfig`, `GraphqlConfig` and `CompatibilityConfig` metadata objects are now not defined as supergraph globals
  but can instead be defined in any subgraph of the supergraph. Note that these are still supergraph-level objects and
  only one of these objects can be defined across the supergraph, but they can now be defined in any of the subgraphs
  based on convenience. By default, these are now added to a new **globals** subgraph.
- The DDN CLI now uses [SemVer](https://semver.org/) instead of CalVer for versioning.

:::info No changes to existing DDN projects

Note that this is a CLI-only change and does not impact Hasura DDN projects. You can continue using existing DDN projects
and builds and also be able to create new builds using the new CLI revision (with the new local project structure).

:::


## Migrate an existing local project

Below are steps to convert a local project created with the DDN CLI versions `<= v2024.06.09` to the new project
structure.

### Step 1: Get the new CLI

<InstallTheCli />

Also, update your Hasura VS Code extension to `v1.0.0` if not done automatically.

:::info Need the previous CLI revision?

Note that the above will overwrite your current DDN CLI revision. You can re-install the previous revision by replacing
`/ddn/cli/v3/` with `/ddn/cli/v2/` in the above download command.
:::

### Step 2: Upgrade existing Supergraph config v1 objects

You can update your existing Supergraph config v1 objects in your local project by running the following in your
project directory:

```bash
ddn codemod upgrade-supergraph-config-v1-to-v2 --dir <project-dir-path>
```

This will detect any existing Supergraph v1 objects in your project directory and initialize a wizard to update them
to the v2 format and make any other related changes, such as initializing the newly introduced Subgraph config objects
and setting up the new **globals** subgraph.

### Step 3: Create new **globals** subgraph on the DDN project

Run the following command to create a new **globals** subgraph on your DDN project:

```bash
ddn project subgraph create globals --project <project-name>
```

### Step 4: Verify the migration

Create a new supergraph build using:

```bash
ddn supergraph build create --supergraph ./supergraph.cloud.yaml
```

On build completion, the build version, API endpoint, and console URLs will be returned as in the response.

You can now head to your project console using the console URL returned in the previous step and verify the API
generated with the above build is the same as what you had earlier.

## Need help?

If you need help migrating your project or have any other questions please reach out to us on
our [Discord](https://hasura.io/discord).


