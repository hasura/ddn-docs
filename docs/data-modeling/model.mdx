---
sidebar_position: 2
sidebar_label: "Models read data"
description: "Models allow you to define the structure of your data and how it can be queried."
keywords:
  - model
  - data modeling
toc_max_heading_level: 3
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import Thumbnail from "@site/src/components/Thumbnail";

import ModelCreatePostgreSQL from "@site/docs/data-modeling/_partials/_classic-connectors/_postgreSQL/_model-create.mdx";
import ModelCreateMongoDB from "@site/docs/data-modeling/_partials/_classic-connectors/_mongoDB/_model-create.mdx";
import ModelCreateClickHouse from "@site/docs/data-modeling/_partials/_classic-connectors/_clickhouse/_model-create.mdx";
import ModelExtendNativeQueryPostgreSQL from "@site/docs/data-modeling/_partials/_classic-connectors/_postgreSQL/_model-extend-native-query.mdx";
import ModelExtendNativeQueryMongoDB from "@site/docs/data-modeling/_partials/_classic-connectors/_mongoDB/_model-extend-native-query.mdx";
import ModelExtendNativeQueryClickHouse from "@site/docs/data-modeling/_partials/_classic-connectors/_clickhouse/_model-extend-native-query.mdx";
import ModelExtendLambdaTypescript from "@site/docs/data-modeling/_partials/_lambda-connectors/_typescript/_modelExtend.mdx";
import ModelExtendLambdaPython from "@site/docs/data-modeling/_partials/_lambda-connectors/_python/_modelExtend.mdx";
import ModelExtendLambdaGo from "@site/docs/data-modeling/_partials/_lambda-connectors/_go/_modelExtend.mdx";

# Models Read Data

## Introduction

In DDN, **Models** represent entities that can be queried in your data sources, such as tables, views, collections,
native queries, and more.

## Lifecycle

The lifecycle in creating a model in your metadata is as follows:

1. Have some entity in your data source that you want to make queryable via your API.
2. Introspect your data source using the DDN CLI with the relevant data connector to fetch the entity resources.
3. Add the model to your metadata with the DDN CLI.
4. Create a build of your supergraph API with the DDN CLI.
5. Serve your build as your API with the Hasura engine either locally or in the cloud.
6. Iterate on your API by repeating this process or by editing your metadata manually as needed.

![](/img/data-modeling/ddn-cli-process.png)

## Create a model

To add a model you will need to have a data connector already set up and connected to the data source. Follow the
[Quickstart](/getting-started/quickstart) or the tutorial in [How to Build with DDN](/getting-started/overview.mdx) to
get to that point.

```bash title="Introspect your data source:"
ddn connector introspect <connector_name>
```

Whenever you update your data source, you can run the above command to fetch the latest resources.

```bash title="Show the resources discovered from your data source:"
ddn connector show-resources <connector_name>
```

This is an optional step and will output a list of resources that DDN discovered in your data source in the previous
step.

```bash
ddn model add <connector_link_name> <collection_name>
```

Or you can optionally add all the models by specifying `"*"`.

```bash
ddn model add <connector_link_name> "*"
```

This will add models with their accompanying metadata definitions to your metadata.

You can now build your supergraph API, serve it, and query your data.

:::info Context for CLI commands

Note that the above CLI commands work without also adding the relevant subgraph to the command with the `--subgraph`
flag because this has been set in the CLI context. You can learn more about creating and switching contexts in the
[CLI context](/getting-started/overview.mdx) section. {/* TODO: Add link */}

:::

For a walkthrough on how to create a model, see the [Model Tutorials](#model-tutorials) section.

## Update a model

If you want to update your model to reflect a change that happened in the underlying data source you should first
introspect to get the latest resources and then update the relevant model.

```bash title="Introspect your data source:"
ddn connector introspect <connector_name>
```

```bash title="Then, update your existing model:"
ddn model update <connector_link_name> <model_name>
```

You will see an output which explains how new resources were added or updated in the model.

You can now build your supergraph API, serve it, and query your data with the updated model.

You can also update the model by editing the metadata manually.

For a walkthrough on how to update a model, see the [Model Tutorials](#model-tutorials) section.

## Extend a model

A model can be extended with more data by adding a native query or a relationship to another data type, including one
exposed via a lambda data connector, in order to return nested data or enrich the returning data.

### Native query

You can create a native query to run on the underlying data source and then expose it as an additional field on your
model. The process of adding a native query is more or less unique for each data connector as each data source by nature
has its own syntax.

Discover how to add a native query for your data connector in the relevant section [here](/).

{/* TODO: Add link */}

### Relationship

With a relationship you can extend a model to another model or command, including commands exposed via a lambda data
connector.

The DDN CLI and your data connectors will detect many relationships in your data sources automatically and once
introspected, you can add them to your metadata.

```bash title="Introspect your data source:"
ddn connector introspect <connector_name>
```

```bash title="Add relationships to your metadata:"
ddn relationship add <connector_link_name> <collection_name>
```

For example, if I wanted to extend my `Customers` model to be able to include their `Orders` when I queried it, my
relationship would be something like:

```yaml title="Relationship definition:"
---
kind: Relationship
version: v1
definition:
  name: orders
  sourceType: Customers
  target:
    model:
      name: Orders
      relationshipType: Array
      aggregate:
        aggregateExpression: OrdersAggExp
  mapping:
    - source:
        fieldPath:
          - fieldName: customerId
      target:
        modelField:
          - fieldName: customerId
  graphql:
    aggregateFieldName: ordersAggregate
```

Read more about relationships in the [Relationships](/data-modeling/relationship.mdx) section. Or see the tutorial
[below](#tutorial-extend-model) on extending a model.

## Delete a model

```bash title="If you no longer need a model, you can delete it:"
ddn model remove users
```

In addition to removing the Model object itself, the DDN CLI will also remove the associated metadata definitions.

## Model Tutorials {#model-tutorials}

The tutorials below follow on from each particular tutorial in the
[How to Build with DDN](/getting-started/overview.mdx) section. Select the relevant data connector to follow the
tutorial.

### Creating a model

To query data from your API, you'll first need to create a model that represents that data.

<Tabs groupId="source-preference" className="api-tabs">
  <TabItem value="PostgreSQL" label="PostgreSQL">

    <ModelCreatePostgreSQL />

  </TabItem>
  <TabItem value="MongoDB" label="MongoDB">

    <ModelCreateMongoDB />

  </TabItem>
  <TabItem value="ClickHouse" label="ClickHouse">

    <ModelCreateClickHouse />

  </TabItem>
</Tabs>

### Updating a model

Your underlying data source may change over time. You can update your model to reflect these changes.

You'll need to update the mapping of your model to the data source by updating the
[DataConnectorLink](/supergraph-modeling/data-connector-links.mdx) object.

```bash title="Introspect your data source:"
ddn connector introspect <connector_name>
```

```bash title="Then, update your model:"
ddn model update <connector_link_name> <model_name>
```

### Extending a model {#tutorial-extend-model}

Models can be extended, allowing for transformation and enrichment of the data.

#### Via a native query

<Tabs groupId="source-preference" className="api-tabs">
  <TabItem value="PostgreSQL" label="PostgreSQL">

    <ModelExtendNativeQueryPostgreSQL />

  </TabItem>
  <TabItem value="MongoDB" label="MongoDB">

    <ModelExtendNativeQueryMongoDB />

  </TabItem>
  <TabItem value="ClickHouse" label="ClickHouse">

    <ModelExtendNativeQueryClickHouse />

  </TabItem>
</Tabs>

#### Via a lambda data connector

[Lambda data connectors](/business-logic/overview.mdx) allow you to expose custom business logic via your API. You can
also create [relationships](/data-modeling/relationship.mdx) between an existing model and this business logic to expand
the data a model can return.

We support lambda data connectors for [TypeScript](/business-logic/typescript.mdx),
[Python](/business-logic/python.mdx), and [Go](/business-logic/go.mdx).

<Tabs groupId="source-preference" className="api-tabs">
  <TabItem value="ts" label="TypeScript">

    <ModelExtendLambdaTypescript />

  </TabItem>
  <TabItem value="python" label="Python">

    <ModelExtendLambdaPython />

  </TabItem>
  <TabItem value="go" label="Go">

    <ModelExtendLambdaGo />

  </TabItem>
</Tabs>

### Deleting a model

```bash title="If you no longer need a model, you can delete it:"
ddn model remove users
```

## Reference

You can learn more about models in the metadata reference [docs](/supergraph-modeling/models.mdx).
