---
sidebar_label: Git Workflows
sidebar_position: 2
description:
  "Learn how to manage your Git workflows for both single-repo and multi-repo federation in Hasura DDN.
  This guide will walk you through setting up version control, collaborating with your team, and deploying your supergraph."
keywords:
  - git workflows
  - version control
  - collaboration
  - deployment
  - single-repo federation
  - multi-repo federation
  - subgraphs
  - supergraph
  - hasura ddn
  - data connectors
  - permissions
  - relationships
seoFrontMatterUpdated: true
---

# Git Workflows

It's important to talk about federation in terms of how you will set up your version control as that will have a big
impact on how you work with your team and how you manage your Hasura DDN project.

## Single Repo vs. Multi-repo Federation

Many smaller projects will only need one repository. Often they will need only one subgraph which connects to one
data source, but of course can have more of both. In the case of a single subgraph setup it would typically be named
something like `app`, `default`, `main` or the name of the data source it connects to.

However, teams working on larger projects may want a [SDLC](https://en.wikipedia.org/wiki/Software_development_process)
and CI/CD which is independent of other teams. This is where multi-repo federation shines. Subgraphs in multi-repo
federation can connect to different data sources, with each subgraph managed in its own repository
for added governance, control and clean separation from other teams work. Subgraphs would also typically be named after
the data domain they encapsulate, such as `users`, `orders`, `products`, etc.

## Single Repo Federation

### Creating a new single repo setup

1. Create a new local supergraph normally as per the [getting started guide](/getting-started/build/index.mdx).
2. Push to a new Git repository.
3. Deploy to Hasura DDN as per the [deployment guide](/getting-started/deployment/index.mdx).
4. Add collaborators to the Hasura DDN project [with appropriate permissions](/getting-started/collaborate/invite/) as
   per the [project configuration](/project-configuration/projects.mdx) docs.
5. Add collaborators to the Git repository to allow them to work on the project.
6. Collaborators can add new subgraphs and new data connectors normally, depending on their project permissions.

### Joining an existing single repo setup

1. Ensure you have [been invited and accepted](/getting-started/collaborate/invite/) the invite to the Hasura DDN
   project with the correct permissions and have been added as a collaborator the Git repository.
2. Clone the repository locally.
3. Make your changes, [add more subgraphs](/getting-started/build/init-subgraph) and
   [data connectors](/getting-started/build/03-connect-to-data/index.mdx) as needed.
4. Test your changes locally.
5. [Create a subgraph build](/getting-started/deployment/02-create-a-subgraph.mdx) on Hasura DDN.
6. Test with the build URL.
7. Apply the subgraph to the supergraph (if your permissions allow). Otherwise, request the admin or owner to apply the
subgraph. ** apply the whole supergraph? ** CI/CD?

## Multi-repo Federation

### Creating a New Multi-repo Setup

The setup here is for a main supergraph repository to be created with the `globals` subgraph and any other subgraph
which other teams will work on. Once on DDN, collaborators are added on the subgraph level giving them permissions
to only work on their subgraph.

:::info Globals Subgraph Objects

By convention, the globals subgraph contains supergraph-level metadata objects that apply to the entire supergraph.
These are `AuthConfig`, `CompatibilityConfig` and `GraphqlConfig` as well as the `Subgraph` object which defines the
globals subgraph itself.

:::

1. Create a supergraph normally, as per the [getting started guide](/getting-started/build/index.mdx).
2. Add any other subgraphs which other teams will work on as placeholders so that they can be invited to them.
3. Push the supergraph to a new Git repository. Do not add any collaborators to this repo.
4. Deploy the supergraph to Hasura DDN as per the [deployment guide](/getting-started/deployment/index.mdx).
5. Invite subgraph collaborators to the Hasura DDN project with
   [Subgraph Admin or Subgraph Developer permissions](/getting-started/collaborate/invite/).

### Joining an Existing Multi-repo Setup

In this workflow the collaborator manages a separate supergraph containing just their subgraph and changes
the supergraph context to reference the collaborative project on DDN. The supergraph is fully functional and enables
local development but only contains their subgraph. They can they create subgraph builds on the collaborative DDN project
and if permissions allow, apply the subgraph to the collaborative supergraph.

1. [Accept the invitation](/getting-started/collaborate/invite/) to the Hasura DDN supergraph project.
2. Create a new Git repository for a new project. Or join an existing Git repository.
3. Initialize a new supergraph   project with a subgraph locally.
4. [Set the supergraph context](/project-configuration/config.mdx#context-file) to the existing Hasura DDN
   project.
5. Start and run your supergraph locally and develop and test.
6. [Create a subgraph build](/getting-started/deployment/02-create-a-subgraph.mdx) on the existing Hasura DDN
   supergraph project.
7. Test with the build URL on Hasura DDN.
8. Apply the subgraph to the supergraph if permissions allow. Otherwise, request the owner or admin to apply the
subgraph.

:::tip Existing Git Repositories for Subgraph repos

You can also use an existing repository one and push your subgraph configuration to this repository.

:::

## Connecting Subgraphs with Relationships

When you have multiple subgraphs, either in a single-repo or multi-repo setup, you can link types together using
relationships. This is done by creating a `Relationship` object in the metadata. This object defines how fields from
one type map to fields in another type.

### Single-repo Relationships

In a single-repo setup, relationships are straightforward to manage. As all the subgraphs are in the same
repository, the Hasura VS Code extension can be used to assist with authoring relationships, providing auto-complete and
validation.

### Multi-repo Relationships

In a multi-repo setup, relationships are more challenging to manage. As the subgraphs are in different repositories,
the Hasura VS Code extension cannot be used to assist with authoring relationships. This means that you will need to
manually author the relationships and ensure that the field mappings are correct. You will also need to manually test
the relationships to ensure that they are working as expected.

However, the Hasura DDN console can be used to test relationships across subgraphs. Once you have created a build for
each subgraph, you can use the console to explore the supergraph and test the relationships. This will help you to
ensure that the relationships are working as expected before you deploy the supergraph to production.

### Relationship Example

For more information on how to create `Relationships` check out
[this page](/supergraph-modeling/relationships.mdx). Let's say you have a supergraph with two subgraphs: `users` and
`products`. The `users` subgraph has a `User` type with a field called `favorite_product_id`. The `products` subgraph
has a `Product` type with a field called `id`.

To create a relationship between these two types, you would create a `Relationship` object in the `users` subgraph
metadata.

```yaml
kind: Relationship
version: v1
definition:
  name: favorite_product
  sourceType: User
  target:
    model:
      name: Product
      subgraph: products
      relationshipType: Object
  mapping:
    - source:
        fieldPath:
          - fieldName: favorite_product_id
      target:
        modelField:
          - fieldName: id
```

This `Relationship` object defines a relationship called `favorite_product` from the `User` type to the `Product`
type. The `mapping` field specifies how the `favorite_product_id` field in the `User` type maps to the `id` field
in the `Product` type.

With this relationship defined, you can now query the `favorite_product` field on the `User` type to retrieve the
related `Product`.

```graphql
query {
  users {
    id
    name
    favorite_product {
      id
      name
    }
  }
}
```


















































# Git Workflows


It's important to talk about federation in terms of how you will set up your version control as that will have a big
impact on how you work with your team and how you manage your project.

## Single repo vs multi repo federation

Many smaller projects will only need one subgraph which connects to one data source, with everything managed in one
repository. The subgraph would typically be named something like `app`, `default`, `main` or the name of the data
source it connects to.

However, larger projects may require multiple subgraphs, each connecting to different data sources, with each
subgraph managed in a repository for added governance, control and clean separation from other teams work. This is
where multi-repo federation comes in. Subgraphs would typically be named after the data domain they encapsulate, such as
`users`, `orders`, `products`, etc.

NOTES NOTES NOTES

## Federating subgraphs

### Creating a new Single subgraph Repo

Create a supergraph normally as per [link]

push to git repo

deploy to DDN as per [link]

Add collaborators to the DDN project with supergraph admin / developer permissions or subgraph admin / developer
permissions as per [link]

Add collaborators to the git repo with x permissions as per [link]

Anyone add new subgraphs normally as per [link] depending on permissions (clarify with perms - check if need to be
supergraph admin to CREATE subgraph)

Collaborators see joining below

### Joining an existing Single subgraph Repo

Should have access to the DDN project and the git repo with correct permissions

Collaborators clone the repo

note: add more subgraphs if you want in the same repo (clarify permissions)

Collaborators create subgraph build on DDN

Collaborators test with the build url

Collaborators apply the subgraph to the supergraph if permissions allow otherwise ask the admin to apply the subgraph


### Creating a new multi-repo setup

Create a supergraph normally as per [link]

No subgraphs except for globals

push to git repo - do not add collaborators to this repo

deploy to DDN as per [link]

Add collaborators to the DDN project with subgraph admin / developer permissions as per [link]

Collaborators see multi-repo federation below

### Joining an Existing repo setup

Accept invite to the DDN project

Create / join new supergraph repo

set supergraph context to the existing DDN project

if creating, add new subgraph normally as per [link]

create and push to NEW or existing repo. (maybe subgraph repo is a directory in another project - all ok)

create build on existing DDN

test with the build url

apply the subgraph to the supergraph if permissions allow otherwise ask the admin to apply the subgraph

## Connecting subgraphs with relationships

When you have multiple subgraphs either in a single or multi repo setup, you can types together using
relationships. This is done by creating a blah blah blah....

### Single repo relationships

no problem

### Multi repo relationships

No lsp. In the blind. Test on DDN.






other notes (ignore):
single repo / multi repo
Init a new subgraph (vs “add”)
Setting context
customizing prefixes
Building a subgraph
applying a subgraph
creating relationships to other subgraphs
