---
description: "Learn how to set up a test token and jwt for graphql apis"
keywords:
  - hasura
  - authconfig
  - session variables
  - http request headers
  - graphql API security
  - test token
sidebar_position: 6
sidebar_label: Setup Test JWT
seoFrontMatterUpdated: true
---

# Setup JWT for Testing

By default, your Supergraph is configured to use your Hasura Cloud auth token 
(called personal access token (PAT)) for authentication. While it works out well
for testing from console, it should not be used in an application or shared 
with another user.

Instead, tp test authentication you need to setup an AuthConfig and then genercorresponding token.

### Step 1

Install [`jwt-cli`](https://github.com/mike-engel/jwt-cli) so that you can generate
tokens.

### Step 2

Generate a random string that we'll use as the JWT secret key:

```bash
openssl rand -hex 16
```

Copy this value. You can use any other random string generators, it has to be atleast 32 characters.

### Step 3

Setup an `AuthConfig` in your project which uses this secret key:

```yaml
kind: AuthConfig
version: v1
definition:
  allowRoleEmulationBy: admin
  mode:
    jwt:
      claimsConfig: 
        namespace:
          claimsFormat: Json
          location: "/https:~1~1hasura.io~1jwt~1claims"
      key:
        fixed:
          algorithm: HS256
          key:
            value: "<insert-the-key-generated-in-previous-step>"
      tokenLocation:
        type: Header
        name: Auth-Token
```

### Step 4

Create a supergraph build using this AuthConfig:

```bash
ddn supergraph build create \
  --description "use jwt based authconfig" \
  --supergraph supergraph.cloud.yaml
```

### Step 4

Generate a new JWT:

```bash
jwt encode --secret="<secret-key>" '{"exp": 1739905122,"iat": 1708369122,"https://hasura.io/jwt/claims":{"x-hasura-default-role": "admin","x-hasura-allowed-roles":["admin"]}}'
```

Change `exp`, `iat` or the role claims as needed, or add any other `x-hasura-*` claims.

### Step 5

Use the JWT generated by the CLI on the console by adding it as the value for `Auth-Token` header.
