import Thumbnail from "@site/src/components/Thumbnail";

## What's about to happen?

Entities from your GraphQL schema — such as queries or mutations — are exposed to your API via
[models](/supergraph-modeling/models.mdx). You can use the CLI to generate an `hml` file which will represent a model,
allowing you to easily and declaratively customize authorization rules, create relationships, or even deprecate certain
fields.

<Thumbnail src="/img/get-started/ERD/add-entities.png" alt="Add entities from the source" width="1000px" />

## Add a model

:::tip Required

- [The DDN CLI, VS Code extension, and Docker installed](/getting-started/build/00-prerequisites.mdx)
- A new or existing [supergraph](/getting-started/build/01-init-supergraph.mdx)
- A new or existing [subgraph](/getting-started/build/02-init-subgraph.mdx)
- A [GraphQL connector](/getting-started/build/03-connect-to-data/01-connect-a-source.mdx) initialized
- A [DataConnectorLink](/getting-started/build/03-connect-to-data/02-create-source-metadata.mdx) configured

:::

If you look in your `my_subgraph/metadata/my_graphql.hml` file, you'll see `collections` for each type in your GraphQL
schema. For each of these, you can run the following command to create a model:

```bash title="For example, with a collection of users"
ddn model add --name users \
  --connector-link my_graphql \
  --subgraph my_subgraph/subgraph.yaml
```

:::tip Casing matters

When adding a model, it is critical to use the same casing as the `object_type` from your connector's configuration
file.

:::

## What did this do?

When you ran this command, the CLI generated an `hml` file in the `metadata` directory for the `subgraph` you passed it.
This `hml` file contains all the auto-configured information — such as the names and types of fields — along with
serving as a file to which you can add new metadata objects to customize the model.

<details>
  <summary>
    Click here to see an example `hml` file for a model called `Countries`.
  </summary>

```yaml title="Countries.hml"
---
kind: Command
version: v1
definition:
  name: Country
  outputType: Country
  arguments:
    - name: code
      type: ID!
  source:
    dataConnectorName: my_graphql
    dataConnectorCommand:
      function: country
  graphql:
    rootFieldName: mySubgraph_country
    rootFieldKind: Query

---
kind: CommandPermissions
version: v1
definition:
  commandName: Country
  permissions:
    - role: admin
      allowExecution: true
```

</details>

## Add all your models

If you like, when updating the connector link with the `connector-link update` command you can add the flag
`--add-all-resources` to create every model and command at once.

```bash title="From the root of your project, run:"
ddn connector-link update my_graphql \
  --subgraph my_subgraph/subgraph.yaml \
  --env-file my_subgraph/.env.my_subgraph.local \
  --add-all-resources
```

## Next steps

Your models can now be used to [query data via your API](/getting-started/build/04-build-your-api.mdx). You can also
customize the model by adding access-control rules, creating relationships to other entities, or deprecating certain
fields.
